(self.webpackChunkapp=self.webpackChunkapp||[]).push([[455],{6455:(r,i,e)=>{"use strict";e.r(i),e.d(i,{AccountSettingsModule:()=>Y});var t=e(1116),o=e(5425),s=e(3337),a=e(1041),n=e(6318),u=e(2501),c=e.n(u),d=e(1267),l=e(5366),p=e(9721),m=e(2371);function g(r,i,e,t,o,s,a){try{var n=r[s](a),u=n.value}catch(c){return void e(c)}n.done?i(u):Promise.resolve(u).then(t,o)}var f=e(2693);let b=(()=>{class r{constructor(r){this.http=r}actualizaFoto(r,i,e){return(t=function*(){try{const t=`${d.N.base_url}upload/${i}/${e}`,o=new FormData;o.append("imagen",r);const s=yield fetch(t,{method:"PUT",headers:{"x-token":localStorage.getItem("token")||""},body:o});return yield s.json()}catch(t){return console.log(t),!1}},function(){var r=this,i=arguments;return new Promise(function(e,o){var s=t.apply(r,i);function a(r){g(s,e,o,a,n,"next",r)}function n(r){g(s,e,o,a,n,"throw",r)}a(void 0)})})();var t}}return r.\u0275fac=function(i){return new(i||r)(l.LFG(f.eN))},r.\u0275prov=l.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var Z=e(7004),h=e(2552);function v(r,i){1&r&&(l.TgZ(0,"p",39),l._uU(1,"* El nombre no debe estar vacio, o llevar caracteres especiales"),l.qZA())}function A(r,i){1&r&&(l.TgZ(0,"button",40),l._UZ(1,"i",41),l._uU(2," Guardar cambios "),l.qZA())}function T(r,i){1&r&&(l.TgZ(0,"button",42),l._UZ(1,"span",43),l._uU(2," Cargando... "),l.qZA())}function w(r,i){1&r&&(l.TgZ(0,"p",39),l._uU(1,"* Las contrase\xf1as deben ser iguales "),l.qZA())}function q(r,i){1&r&&(l.TgZ(0,"p",39),l._uU(1,"* La contrase\xf1a debe de tener Mayuscula, minuscula, caracter y numero, minimo 6 caracteres"),l.qZA())}function x(r,i){1&r&&(l.TgZ(0,"button",44),l._UZ(1,"i",41),l._uU(2," Guardar cambios"),l.qZA())}function y(r,i){1&r&&(l.TgZ(0,"button",45),l._UZ(1,"span",43),l._uU(2," Cargando... "),l.qZA())}function I(r,i){if(1&r&&l._UZ(0,"img",46),2&r){const r=l.oxw();l.hYB("src","",r.path,"upload/usuarios/",null==r.userService.usuario?null:r.userService.usuario.picture,"",l.LSH)}}function S(r,i){1&r&&l._UZ(0,"img",47)}function U(r,i){if(1&r&&l._UZ(0,"img",46),2&r){const r=l.oxw();l.Q6J("src",r.imgTemp,l.LSH)}}function k(r,i){if(1&r&&l._UZ(0,"img",46),2&r){const r=l.oxw();l.Q6J("src",r.imgTemp,l.LSH)}}function _(r,i){if(1&r){const r=l.EpF();l.TgZ(0,"button",48),l.NdJ("click",function(){return l.CHM(r),l.oxw().subirImagen()}),l._UZ(1,"i",41),l._uU(2," Cambiar Imagen"),l.qZA()}if(2&r){const r=l.oxw();l.Q6J("disabled",!r.imagenSubir)}}function N(r,i){1&r&&(l.TgZ(0,"button",45),l._UZ(1,"span",43),l._uU(2," Cargando... "),l.qZA())}const J=[{path:"",component:(()=>{class r{constructor(r,i,e,t,o){this.fb=r,this.siderbarService=i,this.userService=e,this.imgService=t,this.loginService=o,this.imgTemp=null,this.subirimagen=!1,this.path=d.N.base_url,this.formSubmitted=!1,this.formSubmitted1=!1,this.modificarPerfil=!1,this.modificarPerfil1=!1,this.perfilnombre=this.fb.group({nombre:["",[a.kI.required,a.kI.pattern("[a-zA-Z\xe1\xe9\xed\xf3\xfa\xf1\xc1\xc9\xcd\xd3\xda\xd1 ]*")]]}),this.pw=this.fb.group({password:["",[a.kI.required,a.kI.minLength(5),a.kI.pattern(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}$/)]],password2:["",[a.kI.required,a.kI.minLength(5),a.kI.pattern(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}$/)]]},{validators:this.passordIguales("password","password2")})}ngOnInit(){}actualizarPerfil(){var r;this.formSubmitted=!0,this.perfilnombre.invalid||(this.modificarPerfil=!0,this.userService.putUsuario({nombre:this.perfilnombre.controls.nombre.value},null===(r=this.userService.usuario)||void 0===r?void 0:r.idUser).subscribe(r=>{Object.keys(r).length>0&&(this.modificarPerfil=!1,c().fire("Cambios guardados","","success"),this.userService.usuario.nombre=r.usuario.nombre)},r=>{c().fire(r.error.msg,"error")}))}mostrarPassword(r){r?($(".passw1").attr("type","text"),$(".passw2").attr("type","text")):($(".passw1").attr("type","password"),$(".passw2").attr("type","password"))}cambiarImagen(r){n.w.validateImage(r).then(i=>{this.imgTemp=i,this.imagenSubir=r.target.files[0]})}subirImagen(){var r;this.subirimagen=!0,this.imgService.actualizaFoto(this.imagenSubir,"usuarios",null===(r=this.userService.usuario)||void 0===r?void 0:r.idUser).then(r=>{r.ok&&(this.subirimagen=!1,c().fire("Avatar modificado","","success"),this.userService.usuario.picture=r.nombreArchivo)}).catch(r=>{console.log(r),c().fire("No se pudo subir la imagen","","error")})}invalidField(r){return"password"==r?n.w.invalidField(r,this.pw,this.formSubmitted1):n.w.invalidField(r,this.perfilnombre,this.formSubmitted)}actualizarPw(){this.formSubmitted1=!0,this.pw.invalid||(this.modificarPerfil1=!0,this.userService.putPasswordUsuaio({password:this.pw.controls.password.value},this.userService.usuario.idUser).subscribe(r=>{Object.keys(r).length>0&&(this.modificarPerfil1=!1,localStorage.setItem("token",r.token.toString()),c().fire("Cambios Guardados","","success"))},r=>{c().fire(r.error.msg,"error")}))}contrasenasNoValidas(){var r,i;return!((null===(r=this.pw.get("password"))||void 0===r?void 0:r.value)===(null===(i=this.pw.get("password2"))||void 0===i?void 0:i.value)||!this.formSubmitted1)}passordIguales(r,i){return e=>{const t=e.get(r),o=e.get(i);o.setErrors(t.value===o.value?null:{noEsIgual:!0})}}}return r.\u0275fac=function(i){return new(i||r)(l.Y36(a.qu),l.Y36(p.P),l.Y36(m.i),l.Y36(b),l.Y36(Z.r))},r.\u0275cmp=l.Xpm({type:r,selectors:[["app-account-settings"]],decls:78,vars:15,consts:[["id","basic-horizontal-layouts"],[1,"row","match-height"],[1,"col-md-6","col-12"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-content"],[1,"card-body"],["autocomplete","off",1,"form","form-horizontal",3,"formGroup","ngSubmit"],[1,"form-body"],[1,"row"],[1,"col-md-4"],[1,"col-md-8","form-group"],["type","text","id","first-name","formControlName","nombre","placeholder","Nombre",1,"form-control"],["class","text-danger",4,"ngIf"],[1,"col-sm-12","d-flex","justify-content-end"],["class","btn btn-primary",4,"ngIf"],["class","btn btn-primary","type","button","disabled","",4,"ngIf"],["type","password","id","password","formControlName","password","placeholder","Password",1,"form-control","passw1"],["type","password","id","password","formControlName","password2","placeholder","Repetir password",1,"form-control","passw2"],[1,"col-12","col-md-8","offset-md-4","form-group"],[1,"form-check"],[1,"checkbox"],["type","checkbox","id","checkbox1",1,"form-check-input",3,"click"],["mostrar",""],["for","checkbox1"],["class","btn btn-primary btn-block",4,"ngIf"],["class","btn btn-primary btn-block","type","button","disabled","",4,"ngIf"],[1,"text-center"],["class","img-fluid img-circle","alt","User profile picture","style","object-fit: cover;\n                                 width: 100px;\n                                 height: 100px;\n                                 border-radius: 50%;",3,"src",4,"ngIf"],["class","img-fluid img-circle","src","assets/images/no-image-user.png","alt","User profile picture","style","object-fit: cover;\n                        width: 100px;\n                        height: 100px;\n                        border-radius: 50%;",4,"ngIf"],["class","img-fluid img-circle","alt","User profile picture","style","object-fit: cover;\n                        width: 100px;\n                        height: 100px;\n                        border-radius: 50%;",3,"src",4,"ngIf"],[1,"form-group"],["for","exampleInputFile"],[1,"input-group"],[1,"custom-file"],["type","file","id","exampleInputFile",1,"custom-file-input",3,"change"],[1,"card-footer"],["class","btn btn-primary btn-block",3,"disabled","click",4,"ngIf"],[1,"text-danger"],[1,"btn","btn-primary"],[1,"bi","bi-save-fill"],["type","button","disabled","",1,"btn","btn-primary"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],[1,"btn","btn-primary","btn-block"],["type","button","disabled","",1,"btn","btn-primary","btn-block"],["alt","User profile picture",1,"img-fluid","img-circle",2,"object-fit","cover","width","100px","height","100px","border-radius","50%",3,"src"],["src","assets/images/no-image-user.png","alt","User profile picture",1,"img-fluid","img-circle",2,"object-fit","cover","width","100px","height","100px","border-radius","50%"],[1,"btn","btn-primary","btn-block",3,"disabled","click"]],template:function(r,i){if(1&r){const r=l.EpF();l._UZ(0,"app-breadcrumb"),l.TgZ(1,"section",0),l.TgZ(2,"div",1),l.TgZ(3,"div",2),l.TgZ(4,"div",3),l.TgZ(5,"div",4),l.TgZ(6,"h4",5),l._uU(7,"Cambiar nombre"),l.qZA(),l.qZA(),l.TgZ(8,"div",6),l.TgZ(9,"div",7),l.TgZ(10,"form",8),l.NdJ("ngSubmit",function(){return i.actualizarPerfil()}),l.TgZ(11,"div",9),l.TgZ(12,"div",10),l.TgZ(13,"div",11),l.TgZ(14,"label"),l._uU(15,"Nombre"),l.qZA(),l.qZA(),l.TgZ(16,"div",12),l._UZ(17,"input",13),l.qZA(),l.YNc(18,v,2,0,"p",14),l.TgZ(19,"div",15),l.YNc(20,A,3,0,"button",16),l.YNc(21,T,3,0,"button",17),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(22,"div",2),l.TgZ(23,"div",3),l.TgZ(24,"div",4),l.TgZ(25,"h4",5),l._uU(26,"Cambiar password"),l.qZA(),l.qZA(),l.TgZ(27,"div",7),l.TgZ(28,"form",8),l.NdJ("ngSubmit",function(){return i.actualizarPw()}),l.TgZ(29,"div",9),l.TgZ(30,"div",10),l.TgZ(31,"div",11),l.TgZ(32,"label"),l._uU(33,"Password"),l.qZA(),l.qZA(),l.TgZ(34,"div",12),l._UZ(35,"input",18),l.qZA(),l.TgZ(36,"div",11),l.TgZ(37,"label"),l._uU(38,"Repetir password"),l.qZA(),l.qZA(),l.TgZ(39,"div",12),l._UZ(40,"input",19),l.qZA(),l.YNc(41,w,2,0,"p",14),l.YNc(42,q,2,0,"p",14),l.TgZ(43,"div",20),l.TgZ(44,"div",21),l.TgZ(45,"div",22),l.TgZ(46,"input",23,24),l.NdJ("click",function(){l.CHM(r);const e=l.MAs(47);return i.mostrarPassword(e.checked)}),l.qZA(),l.TgZ(48,"label",25),l._uU(49,"Mostrar Password"),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(50,"div",15),l.YNc(51,x,3,0,"button",26),l.YNc(52,y,3,0,"button",27),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(53,"section",0),l.TgZ(54,"div",1),l.TgZ(55,"div",2),l.TgZ(56,"div",3),l.TgZ(57,"div",4),l.TgZ(58,"h4",5),l._uU(59,"Avatar"),l.qZA(),l.qZA(),l.TgZ(60,"div",7),l.TgZ(61,"div",28),l.YNc(62,I,1,2,"img",29),l.YNc(63,S,1,0,"img",30),l.YNc(64,U,1,1,"img",31),l.YNc(65,k,1,1,"img",31),l.qZA(),l.TgZ(66,"div",32),l.TgZ(67,"label",33),l._uU(68,"Cambiar avatar"),l.qZA(),l.TgZ(69,"div",34),l.TgZ(70,"div",35),l.TgZ(71,"input",36),l.NdJ("change",function(r){return i.cambiarImagen(r)}),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(72,"p"),l.TgZ(73,"strong"),l._uU(74," *Tama\xf1o recomendado 300px * 300px, Peso maximo de 2MB "),l.qZA(),l.qZA(),l.qZA(),l.TgZ(75,"div",37),l.YNc(76,_,3,1,"button",38),l.YNc(77,N,3,0,"button",27),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA()}2&r&&(l.xp6(10),l.Q6J("formGroup",i.perfilnombre),l.xp6(8),l.Q6J("ngIf",i.invalidField("nombre")),l.xp6(2),l.Q6J("ngIf",!i.modificarPerfil),l.xp6(1),l.Q6J("ngIf",i.modificarPerfil),l.xp6(7),l.Q6J("formGroup",i.pw),l.xp6(13),l.Q6J("ngIf",i.contrasenasNoValidas()),l.xp6(1),l.Q6J("ngIf",i.invalidField("password")),l.xp6(9),l.Q6J("ngIf",!i.modificarPerfil1),l.xp6(1),l.Q6J("ngIf",i.modificarPerfil1),l.xp6(10),l.Q6J("ngIf",""!=(null==i.userService.usuario?null:i.userService.usuario.picture)&&!i.imgTemp),l.xp6(1),l.Q6J("ngIf",""==(null==i.userService.usuario?null:i.userService.usuario.picture)&&!i.imgTemp),l.xp6(1),l.Q6J("ngIf",""!=(null==i.userService.usuario?null:i.userService.usuario.picture)&&i.imgTemp),l.xp6(1),l.Q6J("ngIf",""==(null==i.userService.usuario?null:i.userService.usuario.picture)&&i.imgTemp),l.xp6(11),l.Q6J("ngIf",!i.subirimagen),l.xp6(1),l.Q6J("ngIf",i.subirimagen))},directives:[h.L,a._Y,a.JL,a.sg,a.Fj,a.JJ,a.u,t.O5],styles:[""]}),r})()}];let P=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=l.oAB({type:r}),r.\u0275inj=l.cJS({imports:[[s.Bz.forChild(J)],s.Bz]}),r})(),Y=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=l.oAB({type:r}),r.\u0275inj=l.cJS({imports:[[t.ez,o.m,a.UX,P]]}),r})()}}]);